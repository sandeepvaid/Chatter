<link rel="stylesheet" href="css/home.css">
<link rel="stylesheet" href="/css/chatbox.css">
<div id="home-container">

    <section  id="feed-posts">
        <h4>Posts</h4>
    
        <% if(locals.user){%>
    
        <form action="/post/create" method="post" id="new-post-form">
    
            <textarea id="post-form" name="content" cols="30" rows="3" placeholder="Type here... " required></textarea>
            <input type="submit" value="Post">
        </form>
        <%}%>
        <div id="post-list-container">
            <ul>
                <%for(post of posts){ %>
                    <%-include('_post')-%>
                <%}%>
            </ul>
        </div>
    </section>
    
    
    <section id="friend-list">
        <h1>Friends</h1>
        <ul id="all-friends">


            <%if(currUser){%>
                <%for(friend of currUser.friendShips){%>
                    <li>
                        <div class="delete-friend-<%= friend.id%>">
                            <a class="add-friend" class="delete-friend-<%= friend.id%>" href="/friend/add-friend/?id=<%= friend.id%>">
                                <i class="fas fa-times-circle"></i>
                            </a>
                            <a  href="/user/profile/<%= friend.id %>">
                                <%= friend.name%>
                            </a>
                        </div>
                        
                    </li>
                <%}%>
            <%}%> 

            
                         
            
        </ul>

        <h1>All User</h1>

        <ul id="all-user">
            <%for(u of all_users){%>
                <li>
                    <a href="/user/profile/<%= u.id %>">
                        <%= u.name%>
                    </a>
                </li>
            <%}%>
        </ul>
    </section>

    <%- include('_chatbox')%>


    
    
    
</div>

<script src="/js/profile.js"></script>
<script src="/js/comment.js"></script>
<script src="/js/home_post.js"></script>
<script src="/js/toggle_like.js"></script>

<script>
    $('.add-friend').each(function(){
        let self = this;
        let toggleFriend = new AddFriend(self);
    });
</script>



<script>
    $('.toggle-like-button').each(function(){
        let self=this;
        let toggleLike=new ToggleLike(self);
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.0/socket.io.js"></script>
<script src="/js/chat_engine.js"></script>


<%if(locals.user){%>
<script>
    new ChatEngine('user-chat-box','<%= locals.user.email%>')
</script>
<%}%>